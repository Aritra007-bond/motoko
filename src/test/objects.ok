Interpreter:
-- Checking objects.as:
type O = {self : () -> O; x : Nat}
type Q = {this : var Q?}
let ignore : (async ()) -> ()
let o : {self : () -> O; x : Nat}
let p : {get_y : () -> Int; x : Nat}
let q : Q
let tictac : {tac : Int -> (); tic : Int -> ()}
let tictac_actor : actor {tac_msg : Int -> (); tic_msg : Int -> ()}
let tictac_actor_async : actor {tac_msg_async : Int -> async (); tic_msg_async : Int -> async ()}
let tictac_async : {tac_async : Int -> async (); tic_async : Int -> async ()}
-- Interpreting objects.as:
get_y()
  <= 2
self()
  <= {self = func; x = 1}
self()
  <= {self = func; x = 1}
self()
  <= {self = func; x = 1}
tic(10)
  tac(9)
    tic(8)
      tac(7)
        tic(6)
          tac(5)
            tic(4)
              tac(3)
                tic(2)
                  tac(1)
                    tic(0)
                      <= ()
                    <= ()
                  <= ()
                <= ()
              <= ()
            <= ()
          <= ()
        <= ()
      <= ()
    <= ()
  <= ()
-> message tic_msg(10)
tic_async(10)
  -> async objects.as:30.33-30.77
  <= async _ #0
-> message tic_msg_async(10)
-> async objects.as:41.9-41.18
objects.as:42.9-42.12: execution error, arithmetic overflow
<- message tic_msg(10)
  tic_msg(10)
    -> message tac_msg(9)
    <= ()
<- async objects.as:30.33-30.77
  tac_async(9)
    -> async objects.as:31.33-31.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg_async(10)
  tic_msg_async(10)
    -> async objects.as:36.37-36.85
    <= async _ #0
<- async objects.as:41.9-41.18
objects.as:41.15-41.18: execution error, arithmetic overflow
<- message tac_msg(9)
  tac_msg(9)
    -> message tic_msg(8)
    <= ()
<- async objects.as:31.33-31.77
  tic_async(8)
    -> async objects.as:30.33-30.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- async objects.as:36.37-36.85
  -> message tac_msg_async(9)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg(8)
  tic_msg(8)
    -> message tac_msg(7)
    <= ()
<- async objects.as:30.33-30.77
  tac_async(7)
    -> async objects.as:31.33-31.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- message tac_msg_async(9)
  tac_msg_async(9)
    -> async objects.as:37.37-37.85
    <= async _ #0
<- message tac_msg(7)
  tac_msg(7)
    -> message tic_msg(6)
    <= ()
<- async objects.as:31.33-31.77
  tic_async(6)
    -> async objects.as:30.33-30.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- async objects.as:37.37-37.85
  -> message tic_msg_async(8)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg(6)
  tic_msg(6)
    -> message tac_msg(5)
    <= ()
<- async objects.as:30.33-30.77
  tac_async(5)
    -> async objects.as:31.33-31.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg_async(8)
  tic_msg_async(8)
    -> async objects.as:36.37-36.85
    <= async _ #0
<- message tac_msg(5)
  tac_msg(5)
    -> message tic_msg(4)
    <= ()
<- async objects.as:31.33-31.77
  tic_async(4)
    -> async objects.as:30.33-30.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- async objects.as:36.37-36.85
  -> message tac_msg_async(7)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg(4)
  tic_msg(4)
    -> message tac_msg(3)
    <= ()
<- async objects.as:30.33-30.77
  tac_async(3)
    -> async objects.as:31.33-31.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- message tac_msg_async(7)
  tac_msg_async(7)
    -> async objects.as:37.37-37.85
    <= async _ #0
<- message tac_msg(3)
  tac_msg(3)
    -> message tic_msg(2)
    <= ()
<- async objects.as:31.33-31.77
  tic_async(2)
    -> async objects.as:30.33-30.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- async objects.as:37.37-37.85
  -> message tic_msg_async(6)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg(2)
  tic_msg(2)
    -> message tac_msg(1)
    <= ()
<- async objects.as:30.33-30.77
  tac_async(1)
    -> async objects.as:31.33-31.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg_async(6)
  tic_msg_async(6)
    -> async objects.as:36.37-36.85
    <= async _ #0
<- message tac_msg(1)
  tac_msg(1)
    -> message tic_msg(0)
    <= ()
<- async objects.as:31.33-31.77
  tic_async(0)
    -> async objects.as:30.33-30.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- async objects.as:36.37-36.85
  -> message tac_msg_async(5)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg(0)
  tic_msg(0)
    <= ()
<- async objects.as:30.33-30.77
  <= ()
<- message tac_msg_async(5)
  tac_msg_async(5)
    -> async objects.as:37.37-37.85
    <= async _ #0
<- async objects.as:37.37-37.85
  -> message tic_msg_async(4)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg_async(4)
  tic_msg_async(4)
    -> async objects.as:36.37-36.85
    <= async _ #0
<- async objects.as:36.37-36.85
  -> message tac_msg_async(3)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tac_msg_async(3)
  tac_msg_async(3)
    -> async objects.as:37.37-37.85
    <= async _ #0
<- async objects.as:37.37-37.85
  -> message tic_msg_async(2)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg_async(2)
  tic_msg_async(2)
    -> async objects.as:36.37-36.85
    <= async _ #0
<- async objects.as:36.37-36.85
  -> message tac_msg_async(1)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tac_msg_async(1)
  tac_msg_async(1)
    -> async objects.as:37.37-37.85
    <= async _ #0
<- async objects.as:37.37-37.85
  -> message tic_msg_async(0)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg_async(0)
  tic_msg_async(0)
    -> async objects.as:36.37-36.85
    <= async _ #0
<- async objects.as:36.37-36.85
  <= ()
-- Finished objects.as:
let ignore : (async ()) -> () = func
let o : {self : () -> O; x : Nat} = {self = func; x = 1}
let p : {get_y : () -> Int; x : Nat} = {get_y = func; x = 3}
let q : Q = {this = {this = {...}}}
let tictac : {tac : Int -> (); tic : Int -> ()} = {tac = func; tic = func}
let tictac_actor : actor {tac_msg : Int -> (); tic_msg : Int -> ()} = actor {tac_msg = func; tic_msg = func}
let tictac_actor_async : actor {tac_msg_async : Int -> async (); tic_msg_async : Int -> async ()} = actor {tac_msg_async = func; tic_msg_async = func}
let tictac_async : {tac_async : Int -> async (); tic_async : Int -> async ()} = {tac_async = func; tic_async = func}

Compiler:
compile_binop: DivOp
compile_exp: (AsyncE (BinE (LitE (NatLit 1)) DivOp (LitE (NatLit 0))))
compile_exp: (CallE (DotE (VarE tictac_actor_async) tic_msg_async) (LitE (IntLit 10)))
compile_exp: (ObjE
  Actor
  self
  (tic_msg_async
    (DecE
      (FuncD
        tic_msg_async
        (AnnotP (VarP n) (PrimT Int))
        (AsyncT (TupT))
        (AsyncE
          (BlockE
            (ExpD
              (IfE
                (RelE (VarE n) GtOp (LitE (NatLit 0)))
                (CallE
                  (VarE ignore)
                  (CallE
                    (DotE (VarE self) tac_msg_async)
                    (BinE (VarE n) SubOp (LitE (IntLit 1)))
                  )
                )
                (TupE)
              )
            )
          )
        )
      )
    )
    Const
    Public
  )
  (tac_msg_async
    (DecE
      (FuncD
        tac_msg_async
        (AnnotP (VarP n) (PrimT Int))
        (AsyncT (TupT))
        (AsyncE
          (BlockE
            (ExpD
              (IfE
                (RelE (VarE n) GtOp (LitE (NatLit 0)))
                (CallE
                  (VarE ignore)
                  (CallE
                    (DotE (VarE self) tic_msg_async)
                    (BinE (VarE n) SubOp (LitE (IntLit 1)))
                  )
                )
                (TupE)
              )
            )
          )
        )
      )
    )
    Const
    Public
  )
)
compile_exp: (CallE (DotE (VarE tictac_async) tic_async) (LitE (IntLit 10)))
compile_exp: (DecE
  (FuncD
    tic_async
    (AnnotP (VarP n) (PrimT Int))
    (AsyncT (TupT))
    (AsyncE
      (BlockE
        (ExpD
          (IfE
            (RelE (VarE n) GtOp (LitE (NatLit 0)))
            (CallE
              (VarE ignore)
              (CallE
                (DotE (VarE this) tac_async)
                (BinE (VarE n) SubOp (LitE (IntLit 1)))
              )
            )
            (TupE)
          )
        )
      )
    )
  )
)
compile_exp: (DecE
  (FuncD
    tac_async
    (AnnotP (VarP n) (PrimT Int))
    (AsyncT (TupT))
    (AsyncE
      (BlockE
        (ExpD
          (IfE
            (RelE (VarE n) GtOp (LitE (NatLit 0)))
            (CallE
              (VarE ignore)
              (CallE
                (DotE (VarE this) tic_async)
                (BinE (VarE n) SubOp (LitE (IntLit 1)))
              )
            )
            (TupE)
          )
        )
      )
    )
  )
)
compile_exp: (CallE (DotE (VarE tictac_actor) tic_msg) (LitE (IntLit 10)))
compile_exp: (ObjE
  Actor
  self
  (tic_msg
    (DecE
      (FuncD
        tic_msg
        (AnnotP (VarP n) (PrimT Int))
        (TupT)
        (BlockE
          (ExpD
            (IfE
              (RelE (VarE n) GtOp (LitE (NatLit 0)))
              (CallE
                (DotE (VarE self) tac_msg)
                (BinE (VarE n) SubOp (LitE (IntLit 1)))
              )
              (TupE)
            )
          )
        )
      )
    )
    Const
    Public
  )
  (tac_msg
    (DecE
      (FuncD
        tac_msg
        (AnnotP (VarP n) (PrimT Int))
        (TupT)
        (BlockE
          (ExpD
            (IfE
              (RelE (VarE n) GtOp (LitE (NatLit 0)))
              (CallE
                (DotE (VarE self) tic_msg)
                (BinE (VarE n) SubOp (LitE (IntLit 1)))
              )
              (TupE)
            )
          )
        )
      )
    )
    Const
    Public
  )
)
compile_exp: (CallE (DotE (VarE tictac) tic) (LitE (IntLit 10)))
compile_exp: (DecE
  (FuncD
    tic
    (AnnotP (VarP n) (PrimT Int))
    (TupT)
    (IfE
      (RelE (VarE n) GtOp (LitE (NatLit 0)))
      (CallE (DotE (VarE this) tac) (BinE (VarE n) SubOp (LitE (IntLit 1))))
      (TupE)
    )
  )
)
compile_exp: (DecE
  (FuncD
    tac
    (AnnotP (VarP n) (PrimT Int))
    (TupT)
    (IfE
      (RelE (VarE n) GtOp (LitE (NatLit 0)))
      (CallE (DotE (VarE this) tic) (BinE (VarE n) SubOp (LitE (IntLit 1))))
      (TupE)
    )
  )
)
compile_lexp: (DotE (VarE q) this)
compile_lit: NullLit
compile_exp: (CallE (DotE (CallE (DotE (VarE o) self) (TupE)) self) (TupE))
compile_exp: (CallE (DotE (VarE o) self) (TupE))
compile_exp: (DecE (FuncD self (TupP) (VarT O) (VarE this)))
compile_exp: (CallE (DotE (VarE p) get_y) (TupE))
compile_exp: (DecE (FuncD get_y (TupP) (PrimT Int) (VarE y)))
(module
  (type $0 (func (param i32) (result i32)))
  (type $1 (func))
  (memory $0 100)
  (global $0 (mut i32) (i32.const 0))
  (func $0 (type 0) (local i32) (i32.const 0))
  (func $1
    (type 1)
    (local i32 i32 i32 i32 i32 i32 i32 i32)
    (i32.const 36)
    (set_local 0)
    (get_global 0)
    (get_global 0)
    (get_local 0)
    (i32.add)
    (set_global 0)
    (tee_local 0)
    (get_local 0)
    (i32.const 20)
    (i32.add)
    (i32.const 3)
    (i32.store align=1)
    (tee_local 0)
    (get_local 0)
    (i32.const 28)
    (i32.add)
    (i32.const 2)
    (i32.store align=1)
    (tee_local 0)
    (get_local 0)
    (i32.const 32)
    (i32.add)
    (unreachable)
    (i32.store align=1)
    (set_local 1)
    (get_local 1)
    (i32.const 20)
    (i32.add)
    (i32.load align=1)
    (i32.const 3)
    (i32.eq)
    (if (result i32) (then (i32.const 0)) (else (unreachable)))
    (drop)
    (unreachable)
    (i32.const 2)
    (i32.eq)
    (if (result i32) (then (i32.const 0)) (else (unreachable)))
    (drop)
    (i32.const 28)
    (set_local 0)
    (get_global 0)
    (get_global 0)
    (get_local 0)
    (i32.add)
    (set_global 0)
    (tee_local 0)
    (get_local 0)
    (i32.const 24)
    (i32.add)
    (unreachable)
    (i32.store align=1)
    (tee_local 0)
    (get_local 0)
    (i32.const 20)
    (i32.add)
    (i32.const 1)
    (i32.store align=1)
    (set_local 2)
    (get_local 2)
    (i32.const 20)
    (i32.add)
    (i32.load align=1)
    (i32.const 1)
    (i32.eq)
    (if (result i32) (then (i32.const 0)) (else (unreachable)))
    (drop)
    (unreachable)
    (i32.const 20)
    (i32.add)
    (i32.load align=1)
    (i32.const 1)
    (i32.eq)
    (if (result i32) (then (i32.const 0)) (else (unreachable)))
    (drop)
    (unreachable)
    (i32.const 20)
    (i32.add)
    (i32.load align=1)
    (i32.const 1)
    (i32.eq)
    (if (result i32) (then (i32.const 0)) (else (unreachable)))
    (drop)
    (i32.const 20)
    (set_local 0)
    (get_global 0)
    (get_global 0)
    (get_local 0)
    (i32.add)
    (set_global 0)
    (tee_local 0)
    (get_local 0)
    (i32.const 16)
    (i32.add)
    (unreachable)
    (i32.store align=1)
    (set_local 3)
    (unreachable)
    (i32.const 0)
    (drop)
    (i32.const 16)
    (set_local 0)
    (get_global 0)
    (get_global 0)
    (get_local 0)
    (i32.add)
    (set_global 0)
    (tee_local 0)
    (get_local 0)
    (i32.const 8)
    (i32.add)
    (unreachable)
    (i32.store align=1)
    (tee_local 0)
    (get_local 0)
    (i32.const 12)
    (i32.add)
    (unreachable)
    (i32.store align=1)
    (set_local 4)
    (unreachable)
    (drop)
    (unreachable)
    (set_local 5)
    (unreachable)
    (drop)
    (i32.const 8)
    (set_local 0)
    (get_global 0)
    (get_global 0)
    (get_local 0)
    (i32.add)
    (set_global 0)
    (tee_local 0)
    (get_local 0)
    (i32.const 0)
    (i32.add)
    (unreachable)
    (i32.store align=1)
    (tee_local 0)
    (get_local 0)
    (i32.const 4)
    (i32.add)
    (unreachable)
    (i32.store align=1)
    (set_local 6)
    (unreachable)
    (drop)
    (unreachable)
    (set_local 7)
    (unreachable)
    (drop)
    (unreachable)
    (drop)
    (i32.const 1)
    (i32.const 0)
    (unreachable)
    (tee_local 0)
    (get_local 0)
    (drop)
    (drop)
  )
  (start 1)
)
Interpreting the .wat:
objects.wat:33.5-33.18: runtime trap: unreachable executed
