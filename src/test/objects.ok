Interpreter:
-- Checking objects.as:
type O = {self : () -> O}
type Q = {this : var Q?}
let ignore : (async ()) -> ()
let o : {self : () -> O}
let oo : O
let p : {get_y : () -> Int; x : Nat}
let q : Q
let tictac : {tac : Int -> (); tic : Int -> ()}
let tictac_actor : actor {tac_msg : Int -> (); tic_msg : Int -> ()}
let tictac_actor_async : actor {tac_msg_async : Int -> async (); tic_msg_async : Int -> async ()}
let tictac_async : {tac_async : Int -> async (); tic_async : Int -> async ()}
let x : Nat
let y : Int
-- Interpreting objects.as:
get_y()
  <= 2
self()
  <= {self = func}
tic(10)
  tac(9)
    tic(8)
      tac(7)
        tic(6)
          tac(5)
            tic(4)
              tac(3)
                tic(2)
                  tac(1)
                    tic(0)
                      <= ()
                    <= ()
                  <= ()
                <= ()
              <= ()
            <= ()
          <= ()
        <= ()
      <= ()
    <= ()
  <= ()
-> message tic_msg(10)
tic_async(10)
  -> async objects.as:28.33-28.77
  <= async _ #0
-> message tic_msg_async(10)
-> async objects.as:39.9-39.18
objects.as:40.9-40.12: execution error, arithmetic overflow
<- message tic_msg(10)
  tic_msg(10)
    -> message tac_msg(9)
    <= ()
<- async objects.as:28.33-28.77
  tac_async(9)
    -> async objects.as:29.33-29.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg_async(10)
  tic_msg_async(10)
    -> async objects.as:34.37-34.85
    <= async _ #0
<- async objects.as:39.9-39.18
objects.as:39.15-39.18: execution error, arithmetic overflow
<- message tac_msg(9)
  tac_msg(9)
    -> message tic_msg(8)
    <= ()
<- async objects.as:29.33-29.77
  tic_async(8)
    -> async objects.as:28.33-28.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- async objects.as:34.37-34.85
  -> message tac_msg_async(9)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg(8)
  tic_msg(8)
    -> message tac_msg(7)
    <= ()
<- async objects.as:28.33-28.77
  tac_async(7)
    -> async objects.as:29.33-29.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- message tac_msg_async(9)
  tac_msg_async(9)
    -> async objects.as:35.37-35.85
    <= async _ #0
<- message tac_msg(7)
  tac_msg(7)
    -> message tic_msg(6)
    <= ()
<- async objects.as:29.33-29.77
  tic_async(6)
    -> async objects.as:28.33-28.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- async objects.as:35.37-35.85
  -> message tic_msg_async(8)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg(6)
  tic_msg(6)
    -> message tac_msg(5)
    <= ()
<- async objects.as:28.33-28.77
  tac_async(5)
    -> async objects.as:29.33-29.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg_async(8)
  tic_msg_async(8)
    -> async objects.as:34.37-34.85
    <= async _ #0
<- message tac_msg(5)
  tac_msg(5)
    -> message tic_msg(4)
    <= ()
<- async objects.as:29.33-29.77
  tic_async(4)
    -> async objects.as:28.33-28.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- async objects.as:34.37-34.85
  -> message tac_msg_async(7)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg(4)
  tic_msg(4)
    -> message tac_msg(3)
    <= ()
<- async objects.as:28.33-28.77
  tac_async(3)
    -> async objects.as:29.33-29.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- message tac_msg_async(7)
  tac_msg_async(7)
    -> async objects.as:35.37-35.85
    <= async _ #0
<- message tac_msg(3)
  tac_msg(3)
    -> message tic_msg(2)
    <= ()
<- async objects.as:29.33-29.77
  tic_async(2)
    -> async objects.as:28.33-28.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- async objects.as:35.37-35.85
  -> message tic_msg_async(6)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg(2)
  tic_msg(2)
    -> message tac_msg(1)
    <= ()
<- async objects.as:28.33-28.77
  tac_async(1)
    -> async objects.as:29.33-29.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg_async(6)
  tic_msg_async(6)
    -> async objects.as:34.37-34.85
    <= async _ #0
<- message tac_msg(1)
  tac_msg(1)
    -> message tic_msg(0)
    <= ()
<- async objects.as:29.33-29.77
  tic_async(0)
    -> async objects.as:28.33-28.77
    <= async _ #0
  ignore(async _ #0)
    <= ()
  <= ()
<- async objects.as:34.37-34.85
  -> message tac_msg_async(5)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg(0)
  tic_msg(0)
    <= ()
<- async objects.as:28.33-28.77
  <= ()
<- message tac_msg_async(5)
  tac_msg_async(5)
    -> async objects.as:35.37-35.85
    <= async _ #0
<- async objects.as:35.37-35.85
  -> message tic_msg_async(4)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg_async(4)
  tic_msg_async(4)
    -> async objects.as:34.37-34.85
    <= async _ #0
<- async objects.as:34.37-34.85
  -> message tac_msg_async(3)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tac_msg_async(3)
  tac_msg_async(3)
    -> async objects.as:35.37-35.85
    <= async _ #0
<- async objects.as:35.37-35.85
  -> message tic_msg_async(2)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg_async(2)
  tic_msg_async(2)
    -> async objects.as:34.37-34.85
    <= async _ #0
<- async objects.as:34.37-34.85
  -> message tac_msg_async(1)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tac_msg_async(1)
  tac_msg_async(1)
    -> async objects.as:35.37-35.85
    <= async _ #0
<- async objects.as:35.37-35.85
  -> message tic_msg_async(0)
  ignore(async _ #0)
    <= ()
  <= ()
<- message tic_msg_async(0)
  tic_msg_async(0)
    -> async objects.as:34.37-34.85
    <= async _ #0
<- async objects.as:34.37-34.85
  <= ()
-- Finished objects.as:
let ignore : (async ()) -> () = func
let o : {self : () -> O} = {self = func}
let oo : O = {self = func}
let p : {get_y : () -> Int; x : Nat} = {get_y = func; x = 3}
let q : Q = {this = {this = {...}}}
let tictac : {tac : Int -> (); tic : Int -> ()} = {tac = func; tic = func}
let tictac_actor : actor {tac_msg : Int -> (); tic_msg : Int -> ()} = actor {tac_msg = func; tic_msg = func}
let tictac_actor_async : actor {tac_msg_async : Int -> async (); tic_msg_async : Int -> async ()} = actor {tac_msg_async = func; tic_msg_async = func}
let tictac_async : {tac_async : Int -> async (); tic_async : Int -> async ()} = {tac_async = func; tic_async = func}
let x : Nat = 3
let y : Int = 2

Compiler:
compile_exp: (ObjE
  Object
  anon-object-1.9
  (x (LitE (NatLit 3)) Const Public)
  (y (LitE (NatLit 2)) Const Private)
  (get_y (DecE (FuncD get_y (TupP) (PrimT Int) (VarE y))) Const Public)
)
compile_exp: (DotE (VarE p) x)
compile_exp: (CallE (DotE (VarE p) get_y) (TupE))
compile_dec: (TypD O (ObjT Object (self (FuncT (TupT) (VarT O)) Const)))
compile_exp: (ObjE
  Object
  this
  (self (DecE (FuncD self (TupP) (VarT O) (VarE this))) Const Public)
)
compile_exp: (CallE (DotE (VarE o) self) (TupE))
compile_dec: (TypD Q (ObjT Object (this (OptT (VarT Q)) Var)))
compile_exp: (ObjE Object anon-object-10.13 (this (LitE NullLit) Var Public))
compile_lexp: (DotE (VarE q) this)
compile_exp: (ObjE
  Object
  this
  (tic
    (DecE
      (FuncD
        tic
        (AnnotP (VarP n) (PrimT Int))
        (TupT)
        (IfE
          (RelE (VarE n) GtOp (LitE (NatLit 0)))
          (CallE (DotE (VarE this) tac) (BinE (VarE n) SubOp (LitE (IntLit 1))))
          (TupE)
        )
      )
    )
    Const
    Public
  )
  (tac
    (DecE
      (FuncD
        tac
        (AnnotP (VarP n) (PrimT Int))
        (TupT)
        (IfE
          (RelE (VarE n) GtOp (LitE (NatLit 0)))
          (CallE (DotE (VarE this) tic) (BinE (VarE n) SubOp (LitE (IntLit 1))))
          (TupE)
        )
      )
    )
    Const
    Public
  )
)
compile_dec: (LetD (TupP) (CallE (DotE (VarE tictac) tic) (LitE (IntLit 10))))
compile_exp: (ObjE
  Actor
  self
  (tic_msg
    (DecE
      (FuncD
        tic_msg
        (AnnotP (VarP n) (PrimT Int))
        (TupT)
        (BlockE
          (ExpD
            (IfE
              (RelE (VarE n) GtOp (LitE (NatLit 0)))
              (CallE
                (DotE (VarE self) tac_msg)
                (BinE (VarE n) SubOp (LitE (IntLit 1)))
              )
              (TupE)
            )
          )
        )
      )
    )
    Const
    Public
  )
  (tac_msg
    (DecE
      (FuncD
        tac_msg
        (AnnotP (VarP n) (PrimT Int))
        (TupT)
        (BlockE
          (ExpD
            (IfE
              (RelE (VarE n) GtOp (LitE (NatLit 0)))
              (CallE
                (DotE (VarE self) tic_msg)
                (BinE (VarE n) SubOp (LitE (IntLit 1)))
              )
              (TupE)
            )
          )
        )
      )
    )
    Const
    Public
  )
)
compile_dec: (LetD WildP (CallE (DotE (VarE tictac_actor) tic_msg) (LitE (IntLit 10))))
compile_exp: (ObjE
  Object
  this
  (tic_async
    (DecE
      (FuncD
        tic_async
        (AnnotP (VarP n) (PrimT Int))
        (AsyncT (TupT))
        (AsyncE
          (BlockE
            (ExpD
              (IfE
                (RelE (VarE n) GtOp (LitE (NatLit 0)))
                (CallE
                  (VarE ignore)
                  (CallE
                    (DotE (VarE this) tac_async)
                    (BinE (VarE n) SubOp (LitE (IntLit 1)))
                  )
                )
                (TupE)
              )
            )
          )
        )
      )
    )
    Const
    Public
  )
  (tac_async
    (DecE
      (FuncD
        tac_async
        (AnnotP (VarP n) (PrimT Int))
        (AsyncT (TupT))
        (AsyncE
          (BlockE
            (ExpD
              (IfE
                (RelE (VarE n) GtOp (LitE (NatLit 0)))
                (CallE
                  (VarE ignore)
                  (CallE
                    (DotE (VarE this) tic_async)
                    (BinE (VarE n) SubOp (LitE (IntLit 1)))
                  )
                )
                (TupE)
              )
            )
          )
        )
      )
    )
    Const
    Public
  )
)
compile_dec: (LetD WildP (CallE (DotE (VarE tictac_async) tic_async) (LitE (IntLit 10))))
compile_exp: (ObjE
  Actor
  self
  (tic_msg_async
    (DecE
      (FuncD
        tic_msg_async
        (AnnotP (VarP n) (PrimT Int))
        (AsyncT (TupT))
        (AsyncE
          (BlockE
            (ExpD
              (IfE
                (RelE (VarE n) GtOp (LitE (NatLit 0)))
                (CallE
                  (VarE ignore)
                  (CallE
                    (DotE (VarE self) tac_msg_async)
                    (BinE (VarE n) SubOp (LitE (IntLit 1)))
                  )
                )
                (TupE)
              )
            )
          )
        )
      )
    )
    Const
    Public
  )
  (tac_msg_async
    (DecE
      (FuncD
        tac_msg_async
        (AnnotP (VarP n) (PrimT Int))
        (AsyncT (TupT))
        (AsyncE
          (BlockE
            (ExpD
              (IfE
                (RelE (VarE n) GtOp (LitE (NatLit 0)))
                (CallE
                  (VarE ignore)
                  (CallE
                    (DotE (VarE self) tic_msg_async)
                    (BinE (VarE n) SubOp (LitE (IntLit 1)))
                  )
                )
                (TupE)
              )
            )
          )
        )
      )
    )
    Const
    Public
  )
)
compile_dec: (LetD
  WildP
  (CallE (DotE (VarE tictac_actor_async) tic_msg_async) (LitE (IntLit 10)))
)
compile_dec: (LetD WildP (AsyncE (BinE (LitE (NatLit 1)) DivOp (LitE (NatLit 0)))))
compile_dec: (LetD WildP (BinE (LitE (NatLit 1)) DivOp (LitE (NatLit 0))))
(module
  (type $0 (func (param i32)))
  (type $1 (func))
  (memory $0 100)
  (global $0 (mut i32) (i32.const 0))
  (func $0 (type 0) (local i32))
  (func $1
    (type 1)
    (local i32 i32 i32 i32 i32 i32 i32 i32 i32 i32 i32)
    (unreachable)
    (set_local 1)
    (unreachable)
    (set_local 2)
    (unreachable)
    (set_local 3)
    (unreachable)
    (set_local 4)
    (unreachable)
    (set_local 5)
    (unreachable)
    (set_local 6)
    (unreachable)
    (unreachable)
    (set_local 7)
    (unreachable)
    (set_local 8)
    (unreachable)
    (set_local 9)
    (unreachable)
    (set_local 10)
  )
  (start 1)
)
Interpreting the .wat:
objects.wat:10.5-10.18: runtime trap: unreachable executed
